!function(t){function e(i){if(n[i])return n[i].exports;var s=n[i]={i:i,l:!1,exports:{}};return t[i].call(s.exports,s,s.exports,e),s.l=!0,s.exports}var n={};e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=2)}([function(t,e,n){const i=n(3),s=n(4),o=n(19),r=n(27);t.exports=class t{constructor(){window.__SOMUD__?(this.state=window.somud.state,this.socket=window.somud.socket,this.socket.app=this,window.__SOMUD__.deactivate(),window.__SOMUD__=null):(this.socket=new o(this),this.state={}),this._app=document.getElementById("app"),this._app.innerHTML="",this.display=new i(this),this.prompt=new s(this),this._server=null,this.display.template("intro",{version:r.version,title:r.name.toUpperCase(),description:r.description}),window.__SOMUD__=this}deactivate(){this.prompt.deactivate(),this.prompt=null,this.display.deactivate(),this.display=null,this._app=null}}},function(t,e){},function(t,e,n){const i=n(0);n(1),new i},function(t,e,n){function i(t){return String(t).replace(/[<>]/g,function(t){return a[t]})}const s=n(22),o=n(21),r='<span class="rule"></span>',a={"<":"&lt;",">":"&gt;"};t.exports=class t{constructor(t){this.app=t,this._=document.createElement("div"),this._.id="display",this.app._app.appendChild(this._),this.maxLines=50,this.app.state.lines||(this.app.state.lines=[]),this.app.state.lines.forEach(t=>{this._.appendChild(t)}),window.scrollTo(0,document.body.scrollHeight)}line(...t){const e=document.createElement("div");for(e.className="line",t.forEach(t=>{"string"==typeof t?e.appendChild(document.createTextNode(t)):e.appendChild(t)}),this.app.state.lines.push(e);this.app.state.lines.length>this.maxLines;)this._.removeChild(this.app.state.lines.shift());this._.appendChild(e),window.scrollTo(0,document.body.scrollHeight)}rawline(...t){const e=document.createElement("div");for(e.className="line",e.innerHTML=t.join(""),this.app.state.lines.push(e);this.app.state.lines.length>this.maxLines;)this._.removeChild(this.app.state.lines.shift());this._.appendChild(e),window.scrollTo(0,document.body.scrollHeight)}c(t,...e){const n=document.createElement("span");return n.className=t,e.forEach(t=>{"string"==typeof t?n.appendChild(document.createTextNode(t)):n.appendChild(t)}),n}template(t,e){if(o[t]){const n=s.render(o[t],e);console.log(e),this.process(n)}}process(t){for(t=i(t),t=t.replace(/\[line\]/gi,r);t.match(/\[([^\]\/]+)\](.+?)\[\/\1\]/gi);)t=t.replace(/\[([^\]\/]+)\](.+?)\[\/\1\]/gi,(t,e,n)=>{return"function"==typeof this[e]?this[e](n).outerHTML:n});t.split(/\n/).forEach(t=>{this.rawline(t)})}command(t){const e=this.c("command",t);return e.setAttribute("data-cmd",t),e}system(){return this.c("system",...arguments)}success(){return this.c("success","✔ ",...arguments)}info(){return this.c("info",...arguments)}warn(){return this.c("warn",...arguments)}error(){return this.c("error","✘ ",...arguments)}bold(){return this.c("bold",...arguments)}italic(){return this.c("italic",...arguments)}underline(){return this.c("underline",...arguments)}dim(){return this.c("dim",...arguments)}rainbow(){return this.c("rainbow",...arguments)}normal(){return this.c("normal",...arguments)}area(){return this.c("area",...arguments)}private(){return this.c("private",...arguments)}global(){return this.c("global",...arguments)}emote(){return this.c("emote",...arguments)}room(t){return this.template("room",t)}handshook(){return this.template("handshook")}deactivate(){this._=null,this.app=null}}},function(t,e){const n="> ",i={16:"shift",17:"control",18:"option",91:"leftCommand",93:"rightCommand"},s={8:"backspace",13:"return",27:"esc",188:"comma",190:"period",192:"backtick",220:"backslash",222:"apostrophe"};t.exports=class t{constructor(t){this.app=t,this._=document.createElement("input"),this._.type="text",this._.id="prompt",this._.disabled=!0,this.pre=document.createElement("span"),this.pre.id="pre",this.pre.innerText=n,this.preStack=[],this.heldKeys={},this.gutter=document.createElement("div"),this.gutter.id="gutter",this.gutter.appendChild(this.pre),this.gutter.appendChild(this._),this.app._app.appendChild(this.gutter),this.context=!1,this.concealed=!1,this._handleKeyDown=this.handleKeyDown.bind(this),this._handleKeyUp=this.handleKeyUp.bind(this),this._.addEventListener("keyup",this._handleKeyUp),this._.addEventListener("keydown",this._handleKeyDown),this._refocus=this.refocus.bind(this),this._.addEventListener("blur",this._refocus),this._.focus()}disable(){this._.disabled=!0,this.clear()}enable(){this._.disabled=!1,this._.focus()}clear(){this._.value="",this.context||(this.pre.innerText=this.preStack.pop()||n,this._.type="text",this.concealed=!1)}setPre(t){this.preStack.push(this.pre.innerText),this.pre.innerText=t+" "}setContext(t){this.context=t,this.context.previousPrompt=this.pre.innerText,this.pre.innerHTML=`<span class="command">${n}${t.command} </span>`}clearContext(t){this.context=null,this.clear()}conceal(){this.concealed=!0,this._.type="password"}submit(t){t=t.trim();let e=`${this.pre.innerText} `;this.context&&(e=this.context.previousPrompt,t=`${this.context.command} ${t}`),e+=this.concealed?"•".repeat(t.length):t,this.app.display.line(this.app.display.dim(e)),this.app.socket.message(t)}deactivate(){this._.removeEventListener("keydown",this._handleKeyDown),this._.removeEventListener("keyup",this._handleKeyUp),this._.removeEventListener("blur",this._refocus),this._=null,this.gutter=null,this.pre=null,this.app=null}handleKeyUp(t){const e=t.which||t.keyCode||0,n=s[e],o=i[e];let r=!1;switch(n){case"return":r=!0,this.submit(this._.value),this.clear();break;case"apostrophe":this.context||1!==this._.value.length||(this.setContext({command:'"'===this._.value[0]?"shout":"say"}),r=!0,this._.value="");break;case"esc":this.context&&this.clearContext(),r=!0}o&&(r=!0,this.heldKeys[o]=!1),r&&t.preventDefault()}handleKeyDown(t){const e=t.which||t.keyCode||0,n=i[e],o=s[e];n&&(t.preventDefault(),this.heldKeys[n]=!0),this.context&&"backspace"===o&&0===this._.value.length&&(t.preventDefault(),this.clearContext())}refocus(t){t.preventDefault(),this._.focus()}}},function(t,e){t.exports=function(t){const e=t.sender===t.me,n=t.message,i=t.sender,s=t.recipient;let o=t.range||"normal",r=`[info][${i}]:[/info]`;s?(o="private",r=e?`To [${s}]:`:`[${i}] whispers:`):"area"===o?r=`[info][${i}] shouting:[/info]`:"global"===o?r=`❗️[${i}]:`:"emote"===o&&(r=i),this.app.display.process(`[${o}]${r} ${n}[/${o}]`)}},function(t,e){t.exports=function(t){this._server?this.app.display.line("Trying to reconnect..."):this.app.display.line("Connecting to server..."),this._.emit("handshake","Hello World from client")}},function(t,e){t.exports=function(){this.app.display.line(this.app.display.error("Disconnected from the server.")),this.app.prompt.disable()}},function(t,e,n){const i=n(20);t.exports=function(t){this._server&&this.app.display.line("Reconnected!"),this.app.prompt.enable(),this._server=t;const e=i.getCookie("token");e?this._.emit("token",e):this.app.display.template("handshook")}},function(t,e){t.exports=function(t){const e=[];for(var n in t)e.push({category:n}),t[n].forEach(t=>{e.push(t)}),e.push({isBlank:1});e.pop(),this.app.display.template("help",{commands:e})}},function(t,e,n){t.exports={connect:n(6),disconnect:n(7),handshook:n(8),print:n(14),prompt:n(15),room:n(16),invalidCommand:n(11),tokenCreated:n(17),tokenExpired:n(18),communication:n(5),logout:n(13),login:n(12),help:n(9)}},function(t,e){t.exports=function(t){const e=["I'm sorry, I don't know what you mean by \""+t.split(" ")[0]+'".',"Why, that's an odd thing to say.","Are you sure you meant to say that?","I'm afraid I can't do that."];this.app.display.line(e[Math.floor(Math.random()*e.length)])}},function(t,e){t.exports=function(t){const e=t.sender;this.app.display.process(`[system]${e} logged in.[/system]`)}},function(t,e){t.exports=function(t){const e=t.sender;this.app.display.process(`[system]${e} logged out.[/system]`)}},function(t,e){t.exports=function(t){t.forEach(t=>this.app.display.process(t))}},function(t,e){t.exports=function(t){t.conceal&&this.app.prompt.conceal(),this.app.prompt.setPre(t.message)}},function(t,e){t.exports=function t(t){const e=t.users.slice(0);if(e.length){const n=[e.pop().handle],i=e.map(t=>t.handle).join(", ");i&&n.unshift(i);const s=t.users.length>1?"are":"is";t.others=n.join(", and ")+" "+s+" here."}this.app.display.template("room",t)}},function(t,e){t.exports=function(t){document.cookie=`token=${t};path=/`}},function(t,e){t.exports=function(){this.app.display.template("handshook")}},function(t,e,n){const i=n(10);t.exports=class t{constructor(t){this._=io.connect(window.socketURL),this.app=t,this._server=null;for(let t in i)this._.on(t,i[t].bind(this))}message(t){this._.emit("message",t)}}},function(t,e){t.exports.getCookie=(t=>{const e=t+"=",n=decodeURIComponent(document.cookie),i=n.split(";");for(let t=0;t<i.length;t++){let n=i[t];for(;" "==n.charAt(0);)n=n.substring(1);if(0==n.indexOf(e))return n.substring(e.length,n.length)}return""})},function(t,e,n){t.exports={handshook:n(23),room:n(26),intro:n(25),help:n(24)}},function(t,e,n){var i,s,o;/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */
!function(n,r){"object"==typeof e&&e&&"string"!=typeof e.nodeName?r(e):(s=[e],i=r,void 0!==(o="function"==typeof i?i.apply(e,s):i)&&(t.exports=o))}(0,function(t){function e(t){return"function"==typeof t}function n(t){return m(t)?"array":typeof t}function i(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function s(t,e){return null!=t&&"object"==typeof t&&e in t}function o(t,e){return y.call(t,e)}function r(t){return!o(g,t)}function a(t){return String(t).replace(/[&<>"'`=\/]/g,function(t){return v[t]})}function c(e,n){function s(){if(g&&!v)for(;y.length;)delete f[y.pop()];else y=[];g=!1,v=!1}function o(t){if("string"==typeof t&&(t=t.split(_,2)),!m(t)||2!==t.length)throw new Error("Invalid tags: "+t);a=new RegExp(i(t[0])+"\\s*"),c=new RegExp("\\s*"+i(t[1])),l=new RegExp("\\s*"+i("}"+t[1]))}if(!e)return[];var a,c,l,d=[],f=[],y=[],g=!1,v=!1;o(n||t.tags);for(var E,C,T,U,D,j,O=new u(e);!O.eos();){if(E=O.pos,T=O.scanUntil(a))for(var S=0,L=T.length;S<L;++S)U=T.charAt(S),r(U)?y.push(f.length):v=!0,f.push(["text",U,E,E+1]),E+=1,"\n"===U&&s();if(!O.scan(a))break;if(g=!0,C=O.scan(k)||"name",O.scan(w),"="===C?(T=O.scanUntil(x),O.scan(x),O.scanUntil(c)):"{"===C?(T=O.scanUntil(l),O.scan(b),O.scanUntil(c),C="&"):T=O.scanUntil(c),!O.scan(c))throw new Error("Unclosed tag at "+O.pos);if(D=[C,T,E,O.pos],f.push(D),"#"===C||"^"===C)d.push(D);else if("/"===C){if(!(j=d.pop()))throw new Error('Unopened section "'+T+'" at '+E);if(j[1]!==T)throw new Error('Unclosed section "'+j[1]+'" at '+E)}else"name"===C||"{"===C||"&"===C?v=!0:"="===C&&o(T)}if(j=d.pop())throw new Error('Unclosed section "'+j[1]+'" at '+O.pos);return h(p(f))}function p(t){for(var e,n,i=[],s=0,o=t.length;s<o;++s)(e=t[s])&&("text"===e[0]&&n&&"text"===n[0]?(n[1]+=e[1],n[3]=e[3]):(i.push(e),n=e));return i}function h(t){for(var e,n,i=[],s=i,o=[],r=0,a=t.length;r<a;++r)switch(e=t[r],e[0]){case"#":case"^":s.push(e),o.push(e),s=e[4]=[];break;case"/":n=o.pop(),n[5]=e[2],s=o.length>0?o[o.length-1][4]:i;break;default:s.push(e)}return i}function u(t){this.string=t,this.tail=t,this.pos=0}function l(t,e){this.view=t,this.cache={".":this.view},this.parent=e}function d(){this.cache={}}var f=Object.prototype.toString,m=Array.isArray||function(t){return"[object Array]"===f.call(t)},y=RegExp.prototype.test,g=/\S/,v={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},w=/\s*/,_=/\s+/,x=/\s*=/,b=/\s*\}/,k=/#|\^|\/|>|\{|&|=|!/;u.prototype.eos=function(){return""===this.tail},u.prototype.scan=function(t){var e=this.tail.match(t);if(!e||0!==e.index)return"";var n=e[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n},u.prototype.scanUntil=function(t){var e,n=this.tail.search(t);switch(n){case-1:e=this.tail,this.tail="";break;case 0:e="";break;default:e=this.tail.substring(0,n),this.tail=this.tail.substring(n)}return this.pos+=e.length,e},l.prototype.push=function(t){return new l(t,this)},l.prototype.lookup=function(t){var n,i=this.cache;if(i.hasOwnProperty(t))n=i[t];else{for(var o,r,a=this,c=!1;a;){if(t.indexOf(".")>0)for(n=a.view,o=t.split("."),r=0;null!=n&&r<o.length;)r===o.length-1&&(c=s(n,o[r])),n=n[o[r++]];else n=a.view[t],c=s(a.view,t);if(c)break;a=a.parent}i[t]=n}return e(n)&&(n=n.call(this.view)),n},d.prototype.clearCache=function(){this.cache={}},d.prototype.parse=function(t,e){var n=this.cache,i=n[t];return null==i&&(i=n[t]=c(t,e)),i},d.prototype.render=function(t,e,n){var i=this.parse(t),s=e instanceof l?e:new l(e);return this.renderTokens(i,s,n,t)},d.prototype.renderTokens=function(t,e,n,i){for(var s,o,r,a="",c=0,p=t.length;c<p;++c)r=void 0,s=t[c],o=s[0],"#"===o?r=this.renderSection(s,e,n,i):"^"===o?r=this.renderInverted(s,e,n,i):">"===o?r=this.renderPartial(s,e,n,i):"&"===o?r=this.unescapedValue(s,e):"name"===o?r=this.escapedValue(s,e):"text"===o&&(r=this.rawValue(s)),void 0!==r&&(a+=r);return a},d.prototype.renderSection=function(t,n,i,s){function o(t){return r.render(t,n,i)}var r=this,a="",c=n.lookup(t[1]);if(c){if(m(c))for(var p=0,h=c.length;p<h;++p)a+=this.renderTokens(t[4],n.push(c[p]),i,s);else if("object"==typeof c||"string"==typeof c||"number"==typeof c)a+=this.renderTokens(t[4],n.push(c),i,s);else if(e(c)){if("string"!=typeof s)throw new Error("Cannot use higher-order sections without the original template");null!=(c=c.call(n.view,s.slice(t[3],t[5]),o))&&(a+=c)}else a+=this.renderTokens(t[4],n,i,s);return a}},d.prototype.renderInverted=function(t,e,n,i){var s=e.lookup(t[1]);if(!s||m(s)&&0===s.length)return this.renderTokens(t[4],e,n,i)},d.prototype.renderPartial=function(t,n,i){if(i){var s=e(i)?i(t[1]):i[t[1]];return null!=s?this.renderTokens(this.parse(s),n,i,s):void 0}},d.prototype.unescapedValue=function(t,e){var n=e.lookup(t[1]);if(null!=n)return n},d.prototype.escapedValue=function(e,n){var i=n.lookup(e[1]);if(null!=i)return t.escape(i)},d.prototype.rawValue=function(t){return t[1]},t.name="mustache.js",t.version="2.3.0",t.tags=["{{","}}"];var E=new d;return t.clearCache=function(){return E.clearCache()},t.parse=function(t,e){return E.parse(t,e)},t.render=function(t,e,i){if("string"!=typeof t)throw new TypeError('Invalid template! Template should be a "string" but "'+n(t)+'" was given as the first argument for mustache#render(template, view, partials)');return E.render(t,e,i)},t.to_html=function(n,i,s,o){var r=t.render(n,i,s);if(!e(o))return r;o(r)},t.escape=a,t.Scanner=u,t.Context=l,t.Writer=d,t})},function(t,e){t.exports="[success]Connection successful![/success]\n\nPlease type [command]login[/command] or [command]signup[/command] to begin.\n"},function(t,e){t.exports="Here are a few commands to help get you started:\n\n{{#commands}}\n{{#category}}\n[bold]{{{category}}}[/bold]\n{{/category}}\n{{#command}}\n{{{command}}} -- [italic]{{{description}}}[/italic]\n{{/command}}\n{{#isBlank}}\n\n{{/isBlank}}\n{{/commands}}\n"},function(t,e){t.exports="[line]\nWelcome to ⚔️ [rainbow][bold]{{{title}}}[/bold]: {{{description}}}![/rainbow] ⚔️\n[italic]v{{{version}}}[/italic]\n[line]\n"},function(t,e){t.exports="\n[bold]{{shortDesc}}[/bold]\n\n{{longDesc}}\n{{#others}}\n\n[italic]{{others}}[/italic]\n{{/others}}\n"},function(t,e){t.exports={name:"dungeon.js",version:"0.1.4",description:"A prototype social MUD/MOO",main:"index.js",engines:{node:"7.5.0"},scripts:{test:"NODE_ENV=test istanbul test _mocha -- --check-leaks --recursive --reporter spec",start:"NODE_ENV=development nodemon index.js",build:"NODE_ENV=production webpack -p --progress --colors --config ./webpack.config.production.js"},author:"Kyle Edwards <edwards.kyle.a@gmail.com>",license:"ISC",devDependencies:{"css-loader":"^0.26.2","extract-text-webpack-plugin":"^2.1.0",istanbul:"^0.4.5",mocha:"^3.2.0","node-sass":"^4.5.0",nodemon:"^1.11.0","raw-loader":"^0.5.1","sass-loader":"^6.0.3","style-loader":"^0.13.2",webpack:"fulls1z3/webpack#v2.2.1-harmony","webpack-dev-middleware":"^1.10.1","webpack-hot-middleware":"^2.17.1"},dependencies:{bcrypt:"^1.0.2",ejs:"^2.5.6",express:"^4.14.1",lodash:"^4.17.4",mustache:"^2.3.0",mysql:"^2.13.0",natural:"^0.5.0","socket.io":"^1.7.3",uuid:"^3.0.1"}}}]);